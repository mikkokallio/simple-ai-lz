This is a Software Requirements Specification (SRS) for the AI-Powered Health Triage and Documentation Assistant, designed to leverage and integrate with your existing Azure Landing Zone infrastructure (rg-ailz-lab). The spec emphasizes the dual use-case (Real-Time and Post-Facto) for maximum demo coverage.üìù Software Requirements Specification: AI Health Documentation Assistant1. Introduction1.1 Project GoalTo provide a secure, scalable demonstration application that converts Finnish-language patient-provider dialogue (audio) into a structured, preliminary clinical note using Generative AI and Azure services. The application will showcase both real-time dictation support and post-facto recording processing.1.2 Target AudienceFinnish Governmental Organizations, Cities, and Healthcare providers. The demo must prioritize data security, compliance (FHIR simulation), and scalability.1.3 Existing Infrastructure (rg-ailz-lab)ComponentExisting ServiceNew Deployment ActionComputeAzure Container Apps (ACA)New Container App deployed to existing ACA Environment.ServerlessAzure FunctionsNew C#/Node.js Function App to existing Function Runtime/Plan.Data StorageAzure Blob StorageNew Container (audio-uploads) within existing Storage Account.DatabaseAzure Cosmos DBNew Database and Container (draft-records) within existing Cosmos DB Account.GatewayAzure API Management (APIM)New API Definition pointing to the new Azure Function endpoint.AI ServicesAzure OpenAI / AI FoundryUtilize existing deployment for LLM inference (e.g., gpt-4o or gpt-35-turbo).2. Functional Requirements (FR)FR1: User Interface and InteractionIDRequirementUse CaseFR1.1The front-end shall display two primary interaction modes: "Start Live Dictation" (real-time) and "Upload Recording" (post-facto).Real-Time, Post-FactoFR1.2The front-end shall display the original raw text transcript side-by-side with the AI-generated structured note to enable human review and editing.BothFR1.3The front-end shall provide a simple "Approve & Finalize" button, which marks the record as final in the database and archives the raw audio.BothFR1.4The application shall support Finnish (fi-FI) as the primary language for all speech-to-text and LLM processing.BothFR2: Real-Time Dictation PipelineIDRequirementComponentsFR2.1The ACA front-end shall use the Azure AI Speech SDK to stream microphone audio and display the real-time transcript as interim results.ACA, AI SpeechFR2.2Upon user clicking "Stop," the final transcript text shall be sent synchronously via a secured HTTP POST to the Azure Function API (fn-triage-processor).ACA, APIM, FunctionFR2.3The Azure Function shall call the Azure OpenAI/AI Foundry LLM with the full transcript and prompt for structured output. The process must complete in less than 10 seconds for a 2-minute dialogue.Function, OpenAIFR3: Post-Facto Recording PipelineIDRequirementComponentsFR3.1The front-end shall allow users to upload a prerecorded audio file (MP3/WAV, up to 15 minutes) directly to the Blob Storage container (audio-uploads).ACA, BlobFR3.2An Azure Function Trigger (or Logic App/Event Grid subscription) shall be used to initiate Azure AI Speech Batch Transcription for the uploaded file.Blob, Function, AI SpeechFR3.3Upon completion of batch transcription, a second Azure Function shall retrieve the full transcript and submit it to the Azure OpenAI/AI Foundry LLM for structured documentation.Function, OpenAIFR4: Structured Output and DataIDRequirementComponentsFR4.1The Azure OpenAI prompt shall be engineered to return the output in a strict JSON format simulating a simplified FHIR DocumentReference structure.OpenAIFR4.2The generated structured note shall be written by the Azure Function to the Cosmos DB container (draft-records) with a status field set to draft.Function, Cosmos DBFR4.3Upon FR1.3 (Approve & Finalize), the status field in Cosmos DB shall be updated to final, and a record of the raw audio file URL shall be archived.ACA, Function, Cosmos DB3. Non-Functional Requirements (NFR)NFR1: Security and AuthenticationIDRequirementDetailsNFR1.1Identity Management: Access to the ACA Front-End shall be secured using Microsoft Entra ID (via Azure App Service/ACA authentication).HighNFR1.2Zero Trust Principle: The ACA Front-End shall use a System-Assigned Managed Identity to authenticate calls to the Azure Function via APIM. No secrets or keys shall be stored in the Container App.CriticalNFR1.3API Security: All calls to the Azure Function and subsequently to Azure OpenAI/AI Foundry shall be routed through Azure API Management (APIM) for security policies and rate limiting.HighNFR1.4Secret Management: Any LLM API keys or sensitive connection strings must be retrieved by the Azure Function using a Managed Identity granted access to a Key Vault (if not already using the OpenAI managed identity flow).CriticalNFR2: Performance and ScalabilityIDRequirementDetailsNFR2.1ACA Scaling: The Container App shall be configured to scale based on HTTP traffic (KEDA triggers) to handle simultaneous demo users.MediumNFR2.2Cosmos DB Performance: The Cosmos DB container shall be provisioned with sufficient Request Units (RUs) to ensure low-latency reads and writes (less than 100ms for read/write operations).MediumNFR2.3LLM Optimization: Use of JSON Mode in the LLM call is mandatory to guarantee a parsable, structured output, improving reliability and reducing post-processing time.High4. Simplified FHIR DocumentReference JSON Schema (Target)The Azure Function will instruct the LLM to return a JSON object adhering to this simplified structure.JSON{
  "resourceType": "DocumentReference",
  "id": "[Generated by Function/Cosmos]",
  "status": "draft", 
  "type": {
    "coding": [
      {
        "system": "http://loinc.org",
        "code": "34133-9", 
        "display": "Note, procedure"
      }
    ]
  },
  "subject": {
    "display": "[Extracted Patient Name/ID Placeholder]"
  },
  "context": {
    "encounter": {
      "display": "Clinical Encounter [Date/Time]"
    }
  },
  "custodian": {
    "display": "[Extracted Hospital/Clinic Name Placeholder]"
  },
  "summary": "[LLM GENERATED: A concise, clinical summary of the visit]",
  "clinical_findings": [
    {
      "code": "[LLM EXTRACTED: e.g., ICD-10 Code Placeholder for Diagnosis]",
      "detail": "[LLM EXTRACTED: e.g., Fever, Fatigue, New Medication]"
    }
  ]
}